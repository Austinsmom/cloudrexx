<!-- START category_edit.html -->
<script language="JavaScript" type="text/javascript">
function showOrHide(strElement) {
  if (document.getElementById(strElement).style.display == 'none') {
    document.getElementById(strElement).style.display = 'block';
  } else {
    document.getElementById(strElement).style.display = 'none';
  }
}

function copyText(strType) {
  for (var h=0; h < document.forms.length;h++) {
    for (var i=0; i < document.forms[h].elements.length;i++) {
      //read out all form-elements with the loop
      if(document.forms[h].elements[i].name.search(strType) != -1) {
        if (strType == 'frmUpdateCategory_Name_') {
          document.forms[h].elements[i].value = document.frmUpdateCategory.frmUpdateCategory_Name.value;
        } else {
          document.forms[h].elements[i].value = document.frmUpdateCategory.frmUpdateCategory_Desc.value;
        }
      }
    }
  }
}


function selectLocales(intSelected) {
  var parentCatLocales = cx.jQuery("input[name='frmAddCategory_ParCat_" + intSelected);
  if (parentCatLocales.length) {
    categoryLocaleIds = parentCatLocales.val().split(",");

    // first disable and uncheck all options
    var localeSelect = cx.jQuery("#activeLocalesFrm");
    var localeOptions = localeSelect.find("option");
    localeOptions.prop("disabled", true);
    localeOptions.prop("selected", false);

    // enable and preselect locales off parent category
    var i;
    for (i = 0; i < categoryLocaleIds.length; ++i) {
      var localeOption = cx.jQuery("#forumLanguages_" + categoryLocaleIds[i]);
      localeOption.prop("disabled", false);
      localeOption.prop("selected", true);
    }
    localeSelect.trigger("chosen:updated");
  }
}

cx.ready(function() {

  var preSelectedFrm = cx.jQuery("#activeLocalesFrm").val();
  cx.jQuery("#activeLocalesFrm").chosen({
    width: "30%",
    no_results_text: "{TXT_CORE_LOCALE_DOESNT_EXIST}"
  }).focus(function() {
    // store current selected locales
    preSelectedFrm = cx.jQuery(this).val();
  }).change(function() {
    var nowSelectedFrm = cx.jQuery(this).val();
    if (!nowSelectedFrm) { // empty not allowed, reset to previous value
      cx.jQuery(this).val(preSelectedFrm).change().trigger("chosen:updated");
    }
    preSelectedFrm = nowSelectedFrm;
  });
});
</script>
<form name="frmUpdateCategory" method="post" action="?cmd=Forum&amp;act=category_update">
  <input type="hidden" name="frmUpdateCategory_CategoryId" value="{VALUE_CATEGORY_ID}" />
  <table width="100%" cellspacing="0" cellpadding="3" border="0" align="top" class="adminlist">
    <tr>
      <th colspan="4">{TXT_TITLE_EDIT_CATEGORY}</th>
    </tr>
    <!-- BEGIN isCategory -->
    <input type="hidden" name="frmUpdateCategory_ParentId" value="{VALUE_CATEGORY_NOPARCAT}" />
    <!-- END isCategory -->
    <!-- BEGIN isForum -->
    <tr class="row1">
      <td>{TXT_CATEGORY_ADD_FORUM_PARCAT}</td>
      <td colspan="3">
        {VALUE_CATEGORY_DD}
        <!-- BEGIN forumAllowedParcats -->
        <input type="hidden" name="frmUpdateCategory_ParCat_{FORUM_EDIT_PARCAT_ID}" value="{FORUM_EDIT_PARCAT_VALUES}">
        <!-- END forumAllowedParcats -->
      </td>
    </tr>
    <!-- END isForum -->
    <tr class="row1">
      <td valign="top">{TXT_CATEGORY_EDIT_CATEGORY_NAME}</td>
      <td colspan="3">
        <input type="text" name="frmUpdateCategory_Name" maxlength="100" style="width:30%;" value="{VALUE_NAME}" onChange="copyText('frmUpdateCategory_Name_');" />&nbsp;<a href="javascript:showOrHide('divEditCategoryLang_Name');">{TXT_CATEGORY_EDIT_EXTENDED}</a>
        <div id="divEditCategoryLang_Name" style="display: none;">
          <!-- BEGIN categoryNameFields -->
          <input type="text" name="frmUpdateCategory_Name_{CATEGORY_EDIT_NAME_LANGID}" value="{CATEGORY_EDIT_NAME_VALUE}" style="width:30%; margin-top:1px;" />&nbsp;<label for="frmUpdateCategory_Name_{CATEGORY_EDIT_NAME_LANGID}">{CATEGORY_EDIT_NAME_LANG}</label><br />
          <!-- END categoryNameFields -->
        </div>
      </td>
    </tr>
    <tr class="row1">
      <td valign="top">{TXT_CATEGORY_EDIT_CATEGORY_DESC}</td>
      <td colspan="3">
        <textarea name="frmUpdateCategory_Desc" rows="3" style="width:30%;" onChange="copyText('frmUpdateCategory_Desc_');">{VALUE_DESC}</textarea>&nbsp;<a href="javascript:showOrHide('divEditCategoryLang_Desc');">{TXT_CATEGORY_EDIT_EXTENDED}</a>
          <div id="divEditCategoryLang_Desc" style="display: none;">
            <!-- BEGIN categoryDescFields -->
            <textarea name="frmUpdateCategory_Desc_{CATEGORY_EDIT_DESC_LANGID}" rows="3" style="width:30%; margin-top: 1px;">{CATEGORY_EDIT_DESC_VALUE}</textarea>&nbsp;<label for="divEditCategoryLang_Desc_{CATEGORY_EDIT_DESC_LANGID}">{CATEGORY_EDIT_DESC_LANG}</label><br />
            <!-- END categoryDescFields -->
          </div>

      </td>
    </tr>
    <tr class="row1">
      <td width="10%">{TXT_CATEGORY_EDIT_CATEGORY_LANGUAGES}</td>
      <td width="90%">
        <select id="activeLocalesFrm" name="frmUpdateCategory_Languages[]" multiple>
          <!-- BEGIN forum_language_option -->
          <option
            id="forumLanguages_{FORUM_LANG_ID}"
            value="{FORUM_LANG_ID}"
            {FORUM_LANG_SELECTED}
            {FORUM_LANG_DISABLED}
          >
            {TXT_FORUM_LANG_NAME}
          </option>
          <!-- END forum_language_option -->
        </select>
      </td>
    </tr>
  </table>
  <br />
  <input type="submit" value="{TXT_CATEGORY_EDIT_CATEGORY_BUTTON}" />
</form>
<!-- END category_edit.html -->

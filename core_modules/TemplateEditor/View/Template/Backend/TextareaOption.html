<label for="{TEMPLATEEDITOR_OPTION_NAME}">
    {TEMPLATEEDITOR_OPTION_HUMAN_NAME}
</label>
<textarea rows="3" id="{TEMPLATEEDITOR_OPTION_NAME}"/>{TEMPLATEEDITOR_OPTION_VALUE}</textarea>
<div class="error-box"></div>
<script type="text/javascript">
    jQuery('#{TEMPLATEEDITOR_OPTION_NAME}').focusout(function () {
        jQuery('#{TEMPLATEEDITOR_OPTION_NAME}').parent().addClass('saving');
        updateOption(
            '{TEMPLATEEDITOR_OPTION_NAME}',
            jQuery(this).val(),
            function(response){
                var parent = jQuery('#{TEMPLATEEDITOR_OPTION_NAME}').parent();
                if (response.status == 'error'){
                    jQuery('#{TEMPLATEEDITOR_OPTION_NAME}').parent().addClass('error');
                    jQuery('#{TEMPLATEEDITOR_OPTION_NAME}').nextAll('.error-box:first')
                            .text(response.message).slideDown();
                    return false;
                }
                var splitedId =
                        '#{TEMPLATEEDITOR_OPTION_NAME}'.split('_seriesId');
                if (splitedId.length > 1) { // case: series
                    var textvalue = getSeriesElementValueById(
                            'textvalue',
                            splitedId[1],
                            response.data['elements']
                    );
                } else { // case: single textarea
                    var textvalue = response.data.textvalue;
                }
                jQuery('#{TEMPLATEEDITOR_OPTION_NAME}').nextAll('.error-box:first').slideUp();
                parent.removeClass('error');
                jQuery('#{TEMPLATEEDITOR_OPTION_NAME}').val(textvalue);
                parent.removeClass('saving');
                jQuery('#{TEMPLATEEDITOR_OPTION_NAME}').addClass('saved');
                setTimeout(function(){
                    jQuery('#{TEMPLATEEDITOR_OPTION_NAME}').removeClass('saved');
                }, 2000);
                return true;
            }
        )
    });
</script>